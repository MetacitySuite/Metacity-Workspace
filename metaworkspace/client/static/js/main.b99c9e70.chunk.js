(this["webpackJsonpmetaworkspace-react"]=this["webpackJsonpmetaworkspace-react"]||[]).push([[0],{128:function(e,t,n){},228:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(33),c=n.n(r),s=n(120),o=n(36),l=n(20),u=(n(128),n(129),"/app"),d="/app/login",h="/app/view/:project_name",m="/app/view/",f="/app/projects/:project_name?",j="/app/projects/",p="/app/jobs",b="/app/upload/:project_name",v="/app/upload/",g="/api/projects",O="/api/project",x="/api/project/rename",_="/api/project",y="/api/project/build",w="/api/layers",S="/api/layer",k="/api/layer/rename",E="/api/layer",N="/api/jobs",C="/api/logs",T="/api/log",M="/auth/user",L="/auth/token",R="/api/styles",P="/api/style/create",B=n(14),F=n(38),D=n(230),A=n(46),I=n(60),z=n.n(I);var H=z.a.create({});!function(){var e=localStorage.getItem("JWT");H.defaults.headers.common.Authorization=null===e?null:"Bearer ".concat(e)}();var Y=H,U=n(43),V=n(249),G=n(2),J=function(e){return Object(G.jsx)(V.a,Object(U.a)({is:o.b},e))};function W(e){return Object(G.jsxs)(F.a,{className:"header",children:[Object(G.jsx)(J,{to:u,className:"headerLink ".concat(e.home?"selected":""),children:"Home"}),Object(G.jsx)(J,{to:j,className:"headerLink ".concat(e.projects?"selected":""),children:"Projects"}),Object(G.jsx)(J,{to:p,className:"headerLink ".concat(e.jobs?"selected":""),children:"Jobs & Logs"})]})}function q(){var e=Object(a.useState)([]),t=Object(B.a)(e,2),n=t[0],i=t[1],r=Object(l.g)();return Object(a.useEffect)((function(){return Y.get(g).then((function(e){console.log(e.data),i(e.data)})),function(){i([])}}),[]),Object(G.jsxs)(F.a,{className:"home",children:[Object(G.jsx)(D.a,{className:"homeHeading",children:"Metacity"}),Object(G.jsx)(F.a,{className:"homeProjectList",children:n.map((function(e,t){return Object(G.jsx)(A.a,{height:48,onClick:function(){return r.push(m+e)},children:e},t)}))}),Object(G.jsx)(J,{to:j,className:"homeNav",children:"Go to Controls"})]})}var K=n(276),X=n(268);function Q(e){return Object(G.jsx)(F.a,{children:Object(G.jsx)(F.a,{className:"projectHeader main",children:Object(G.jsxs)(D.a,{className:"wide",children:["Project ",e.name]})})})}var Z=n(255),$=n(256),ee=n(274),te=n(259),ne=n(260),ae=n(261),ie=n(262),re=n(263),ce=n(250),se=n(40);function oe(e){return Object(G.jsx)(ce.a,{isShown:e.isShown,intent:"danger",title:"Recompile project",onConfirm:function(){Y.post(y,{name:e.name}).then((function(t){e.setIsShown(!1),e.onSubmit()}))},onCloseComplete:function(){return e.setIsShown(!1)},confirmLabel:"Recompile",children:Object(G.jsxs)(se.a,{children:["Are you sure you want to recompile project ",e.name,"?"]})})}var le=n(253),ue=n(254);function de(e){var t=Object(a.createRef)(),n=Object(a.useState)(""),i=Object(B.a)(n,2),r=i[0],c=i[1],s=function(n){var a;n&&n.preventDefault();var i=null===(a=t.current)||void 0===a?void 0:a.value;i&&Y.post(P,{project:e.project,name:i}).then((function(n){console.log(n.data),t.current&&(t.current.value=""),e.setIsShown(!1),e.onSubmit()})).catch((function(e){c("Style ".concat(i," already exists"))}))};return Object(a.useEffect)((function(){c("")}),[e.isShown]),Object(G.jsxs)(ce.a,{isShown:e.isShown,title:"Create new style",onConfirm:function(){return s()},onCloseComplete:function(){return e.setIsShown(!1)},confirmLabel:"Create",children:[Object(G.jsx)("form",{className:"dialogForm",onSubmit:s,children:Object(G.jsx)(le.a,{name:"name",placeholder:"Style name",ref:t})}),r.length>0?Object(G.jsx)(ue.a,{intent:"danger",marginTop:16,children:r}):""]})}function he(e){var t=Object(a.createRef)(),n=Object(a.useState)(""),i=Object(B.a)(n,2),r=i[0],c=i[1],s=function(n){var a;n&&n.preventDefault();var i=null===(a=t.current)||void 0===a?void 0:a.value;i&&Y.post(x,{old:e.name,new:i}).then((function(){t.current&&(t.current.value=""),e.setIsShown(!1),e.onSubmit(i)})).catch((function(e){c("Project ".concat(i," already exists"))}))};return Object(a.useEffect)((function(){c("")}),[e.isShown]),Object(G.jsxs)(ce.a,{isShown:e.isShown,title:"Rename project ".concat(e.name),onConfirm:function(){return s()},onCloseComplete:function(){return e.setIsShown(!1)},confirmLabel:"Rename",children:[Object(G.jsx)("form",{className:"dialogForm",onSubmit:s,children:Object(G.jsx)(le.a,{name:"name",placeholder:"New project name",ref:t})}),r.length>0?Object(G.jsx)(ue.a,{intent:"danger",marginTop:16,children:r}):""]})}function me(e){return Object(G.jsx)(ce.a,{isShown:e.isShown,intent:"danger",title:"Delete project",onConfirm:function(){Y.delete(_,{data:{name:e.name}}).then((function(){e.onSubmit(),e.setIsShown(!1)}))},onCloseComplete:function(){return e.setIsShown(!1)},confirmLabel:"Delete",children:Object(G.jsxs)(se.a,{children:["Are you sure you want to delete project ",e.name,"?"]})})}function fe(e){var t=Object(l.g)(),n=Object(a.useState)(!1),i=Object(B.a)(n,2),r=i[0],c=i[1],s=Object(a.useState)(!1),o=Object(B.a)(s,2),u=o[0],d=o[1],h=Object(a.useState)(!1),f=Object(B.a)(h,2),j=f[0],b=f[1],g=Object(a.useState)(!1),O=Object(B.a)(g,2),x=O[0],_=O[1];Object(a.useEffect)((function(){return function(){c(!1),d(!1),b(!1),_(!1)}}),[]);return Object(G.jsxs)(F.a,{className:"actions",children:[Object(G.jsx)(oe,{isShown:j,setIsShown:function(e){return b(e)},onSubmit:function(){t.push(p)},name:e.name}),Object(G.jsx)(de,{project:e.name,isShown:x,setIsShown:function(e){return _(e)},onSubmit:function(){}}),Object(G.jsx)(he,{name:e.name,isShown:r,setIsShown:function(e){return c(e)},onSubmit:e.showProject}),Object(G.jsx)(me,{name:e.name,isShown:u,setIsShown:function(e){return d(e)},onSubmit:function(){return e.showProject()}}),Object(G.jsx)(A.a,{marginRight:12,marginBottom:12,appearance:"minimal",iconBefore:Z.a,onClick:function(){return t.push(v+e.name)},children:"Add Layer"}),Object(G.jsx)(A.a,{marginRight:12,marginBottom:12,appearance:"minimal",iconBefore:$.a,onClick:function(){return _(!0)},children:"Add Style"}),Object(G.jsx)(ee.a,{content:"Recompile after updating layers or styles to view the changes in the visualization",children:Object(G.jsx)(A.a,{marginRight:12,marginBottom:12,appearance:"minimal",iconBefore:te.a,onClick:function(){return b(!0)},children:"Recompile 3D"})}),Object(G.jsx)(A.a,{marginBottom:12,appearance:"minimal",iconBefore:ne.a,onClick:function(){},disabled:!0,children:"Map Layers"}),Object(G.jsx)(A.a,{marginRight:12,marginBottom:12,appearance:"minimal",iconBefore:ae.a,onClick:function(){t.push(m+e.name)},children:"View"}),Object(G.jsx)(A.a,{marginRight:12,marginBottom:12,appearance:"minimal",iconBefore:ie.a,onClick:function(){return c(!0)},children:"Rename"}),Object(G.jsx)(A.a,{marginBottom:12,appearance:"minimal",iconBefore:re.a,onClick:function(){return d(!0)},intent:"danger",children:"Delete Project"})]})}var je=n(273),pe=n(233),be=n(264);function ve(e){var t=Object(a.createRef)(),n=Object(a.useState)(""),i=Object(B.a)(n,2),r=i[0],c=i[1],s=function(n){var a;n&&n.preventDefault();var i=null===(a=t.current)||void 0===a?void 0:a.value;i&&Y.post(k,{project:e.project,old:e.name,new:i}).then((function(){t.current&&(t.current.value=""),e.setIsShown(!1),e.onSubmit(i)})).catch((function(){c("Layer ".concat(i," already exists"))}))};return Object(a.useEffect)((function(){c("")}),[e.isShown]),Object(G.jsxs)(ce.a,{isShown:e.isShown,title:"Rename layer ".concat(e.name),onConfirm:function(){return s()},onCloseComplete:function(){return e.setIsShown(!1)},confirmLabel:"Rename",children:[Object(G.jsx)("form",{className:"dialogForm",onSubmit:s,children:Object(G.jsx)(le.a,{name:"name",placeholder:"New layer name",ref:t})}),Object(G.jsx)("p",{children:r}),r.length>0?Object(G.jsx)(ue.a,{intent:"danger",marginTop:16,children:r}):""]})}function ge(e){return Object(G.jsx)(ce.a,{isShown:e.isShown,title:"Delete layer ".concat(e.name),onConfirm:function(){Y.delete(E,{data:{project:e.project,name:e.name}}).then((function(){e.setIsShown(!1),e.onSubmit()}))},onCloseComplete:function(){return e.setIsShown(!1)},intent:"danger",confirmLabel:"Delete",children:Object(G.jsxs)(se.a,{children:["Are you sure you want to delete layer ",e.name,"?"]})})}function Oe(e){var t=Object(a.useState)([]),n=Object(B.a)(t,2),i=n[0],r=n[1],c=Object(a.useState)(void 0),s=Object(B.a)(c,2),o=s[0],u=s[1],d=Object(a.useState)(!1),h=Object(B.a)(d,2),m=h[0],f=h[1],j=Object(a.useState)(!1),p=Object(B.a)(j,2),b=p[0],g=p[1],O=(Object(l.g)(),function(){Y.post(w,{name:e.name}).then((function(e){console.log("layers",e.data),r(e.data)}))});return Object(a.useEffect)((function(){return O(),function(){r([])}}),[e.name]),Object(G.jsxs)(F.a,{className:"section",children:[m?Object(G.jsx)(ve,{name:o,isShown:m,setIsShown:function(e){return f(e)},onSubmit:O,project:e.name}):"",b?Object(G.jsx)(ge,{name:o,isShown:b,setIsShown:function(e){return g(e)},onSubmit:O,project:e.name}):"",Object(G.jsx)(F.a,{className:"projectHeader",children:Object(G.jsx)(D.a,{className:"wide",is:"h3",children:" Layers"})}),Object(G.jsxs)(je.a,{children:[Object(G.jsxs)(je.a.Head,{className:"row",children:[Object(G.jsx)(je.a.TextHeaderCell,{className:"wide",children:"Layer"}),Object(G.jsx)(je.a.TextHeaderCell,{className:"wide",children:"Number of Objects"}),Object(G.jsx)(je.a.TextHeaderCell,{className:"wide",children:"Type"}),Object(G.jsx)(je.a.TextHeaderCell,{className:"narrow",children:"rename"}),Object(G.jsx)(je.a.TextHeaderCell,{className:"narrow",children:"delete"})]}),Object(G.jsx)(je.a.Body,{children:i.length>0?i.map((function(e){return Object(G.jsxs)(je.a.Row,{paddingY:12,height:"auto",className:"row",children:[Object(G.jsx)(je.a.TextCell,{className:"wide",children:e.name}),Object(G.jsx)(je.a.TextCell,{className:"wide",children:e.size}),Object(G.jsx)(je.a.TextCell,{className:"wide",children:e.type}),Object(G.jsx)(je.a.TextCell,{className:"narrow",children:Object(G.jsx)(pe.a,{icon:ie.a,appearance:"minimal",onClick:function(){u(e.name),f(!0)}})}),Object(G.jsx)(je.a.TextCell,{className:"narrow",children:Object(G.jsx)(pe.a,{icon:re.a,intent:"danger",appearance:"minimal",onClick:function(){u(e.name),g(!0)}})})]},e.name)})):Object(G.jsx)(K.a,{background:"light",title:"No Layers in this Project",orientation:"horizontal",icon:Object(G.jsx)(be.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5",description:"Layers apper after successfull processing of the input files.",anchorCta:Object(G.jsx)(K.a.LinkButton,{is:J,to:v+e.name,children:"Add first layer"})})})]})]})}function xe(e,t){Y.get(M).then((function(e){console.log("user auth",e.data),t()})).catch((function(t){e.push(d)}))}function _e(){var e=Object(a.useState)(""),t=Object(B.a)(e,2),n=t[0],i=t[1],r=Object(l.g)(),c=Object(a.createRef)(),s=Object(a.createRef)();return Object(a.useEffect)((function(){Y.get(M).then((function(){r.push(j)})).catch((function(e){}))}),[]),Object(G.jsx)(F.a,{className:"fullScreen",children:Object(G.jsxs)(F.a,{children:[Object(G.jsx)(D.a,{is:"h1",children:"Login"}),n.length>0?Object(G.jsx)("p",{children:n}):"",Object(G.jsxs)("form",{onSubmit:function(e){var t,n;e.preventDefault();var a=new FormData;a.append("username",(null===(t=c.current)||void 0===t?void 0:t.value)||""),a.append("password",(null===(n=s.current)||void 0===n?void 0:n.value)||""),Y.post(L,a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){console.log(e),localStorage.setItem("JWT",e.data.access_token),Y.defaults.headers.common.Authorization="Bearer ".concat(e.data.access_token),r.push(j)})).catch((function(e){console.error(e),i("There was a problem with your login, check your username and password.")}))},children:[Object(G.jsx)(le.a,{width:"100%",placeholder:"username",ref:c,type:"text"}),Object(G.jsx)(le.a,{width:"100%",placeholder:"password",ref:s,type:"password"}),Object(G.jsx)(le.a,{type:"submit"})]})]})})}function ye(e){var t=Object(a.useState)(!1),n=Object(B.a)(t,2),i=(n[0],n[1],Object(a.useState)(!1)),r=Object(B.a)(i,2),c=(r[0],r[1],Object(a.useState)([])),s=Object(B.a)(c,2),o=s[0],u=s[1],d=Object(l.g)();return Object(a.useEffect)((function(){xe(d,(function(){Y.post(R,{name:e.project}).then((function(e){console.log(e.data),u(e.data)}))}))}),[e.project]),Object(G.jsxs)(F.a,{className:"styles",children:[Object(G.jsx)(F.a,{className:"projectHeader",children:Object(G.jsx)(D.a,{className:"wide",is:"h3",children:"Styles"})}),Object(G.jsx)(F.a,{className:"styleList",children:o.length>0?o.map((function(e){return Object(G.jsxs)(F.a,{className:"styleItem",children:[Object(G.jsx)(F.a,{className:"styleTitle",children:e}),Object(G.jsxs)(F.a,{children:[Object(G.jsx)(A.a,{marginRight:16,appearance:"minimal",iconBefore:ie.a,children:"Rename"}),Object(G.jsx)(A.a,{appearance:"minimal",intent:"danger",iconBefore:re.a,children:"Delete"})]})]},e)})):Object(G.jsx)(K.a,{background:"light",title:"No Styles in this Project",orientation:"vertical",icon:Object(G.jsx)($.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5",description:"Styles modify the appearance of the layer in the visualization according to the layer and object metadata"})})]})}function we(e){return Object(G.jsxs)(F.a,{className:"project",children:[Object(G.jsx)(Q,{name:e.name}),Object(G.jsx)(fe,{name:e.name,showProject:e.showProject}),Object(G.jsx)(Oe,{name:e.name}),Object(G.jsx)(ye,{project:e.name})]})}var Se,ke=n(265),Ee=n(266),Ne=n(267);function Ce(e){return Object(G.jsxs)(F.a,{className:"list",children:[Object(G.jsx)(D.a,{className:"projectList title",children:"Projects"}),Object(G.jsxs)(F.a,{className:"projectList action",onClick:e.onAddDialog,children:[Object(G.jsx)(ke.a,{}),"Add Project"]}),Object(G.jsx)(Ee.a,{className:"projectList tabs",children:e.projects.map((function(t){return Object(G.jsx)(Ne.a,{id:"tab-".concat(t),onSelect:function(){return e.onSelect(t)},isSelected:t===e.currentProject,children:t},t)}))})]})}function Te(e){var t=Object(a.createRef)(),n=Object(a.useState)(""),i=Object(B.a)(n,2),r=i[0],c=i[1],s=function(n){var a;n&&n.preventDefault();var i=null===(a=t.current)||void 0===a?void 0:a.value;i&&Y.post(O,{name:i}).then((function(n){console.log(n.data),t.current&&(t.current.value=""),e.setIsShown(!1),e.onSubmit()})).catch((function(e){c("Project ".concat(i," already exists"))}))};return Object(a.useEffect)((function(){c("")}),[e.isShown]),Object(G.jsxs)(ce.a,{isShown:e.isShown,title:"Create new project",onConfirm:function(){return s()},onCloseComplete:function(){return e.setIsShown(!1)},confirmLabel:"Create",children:[Object(G.jsx)("form",{className:"dialogForm",onSubmit:s,children:Object(G.jsx)(le.a,{name:"name",placeholder:"Project Name",ref:t})}),r.length>0?Object(G.jsx)(ue.a,{intent:"danger",marginTop:16,children:r}):""]})}function Me(){var e=Object(l.h)().project_name,t=Object(a.useState)(e),n=Object(B.a)(t,2),i=n[0],r=n[1],c=Object(a.useState)([]),s=Object(B.a)(c,2),o=s[0],u=s[1],d=Object(a.useState)(!1),h=Object(B.a)(d,2),m=h[0],f=h[1],p=Object(l.g)(),b=function(){Y.get(g).then((function(e){console.log(e.data),u(e.data)}))};Object(a.useEffect)((function(){return xe(p,(function(){b()})),function(){u([])}}),[]);var v=function(e){b(),r(e);var t=j;e&&(t+=e),p.push(t)};return Object(G.jsxs)(F.a,{children:[Object(G.jsx)(Te,{isShown:m,setIsShown:function(e){return f(e)},onSubmit:b}),Object(G.jsx)(W,{projects:!0}),Object(G.jsxs)(F.a,{className:"projects",children:[Object(G.jsx)(Ce,{currentProject:i,onSelect:v,onAddDialog:function(){return f(!0)},projects:o}),Object(G.jsx)(F.a,{className:"content ".concat(i?"":"empty"),justifyContent:"center",alignItems:"center",children:i?Object(G.jsx)(we,{name:i,showProject:v}):Object(G.jsx)(K.a,{background:"light",title:"No project selected",orientation:"vertical",icon:Object(G.jsx)(X.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5"})})]})]})}!function(e){e[e.empty=0]="empty",e[e.exists=1]="exists",e[e.valid=2]="valid"}(Se||(Se={}));var Le=n(231),Re=n(49),Pe=n(119),Be=n(56);function Fe(e){var t=Object(Pe.a)(),n=t.acceptedFiles,i=t.getRootProps,r=t.getInputProps,c=Object(a.createRef)(),s=n.map((function(e){return Object(G.jsxs)("li",{children:[Object(G.jsx)("span",{className:"fileName",children:e.name}),Object(G.jsxs)("span",{className:"fileSize",children:[e.size," bytes"]})]},e.name)}));return Object(G.jsxs)(F.a,{className:"dropzoneContainer",children:[Object(G.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.submit(c.current.value,n)},id:"layerUploadForm",children:[Object(G.jsx)(le.a,{placeholder:"layer name",ref:c,className:"layerName"}),Object(G.jsxs)("div",Object(U.a)(Object(U.a)({},i({className:"dropzone"})),{},{children:[Object(G.jsx)("input",Object(U.a)({},r())),Object(G.jsx)("p",{children:"Click or drag 'n' drop layer files here"}),Object(G.jsx)("ul",{className:"filelist",children:s})]}))]}),Object(G.jsx)(A.a,{marginRight:16,appearance:"primary",type:"submit",form:"layerUploadForm",children:"Upload"})]})}function De(){var e=Object(l.h)().project_name,t=Object(l.g)(),n=Object(a.useState)(0),i=Object(B.a)(n,2),r=i[0],c=i[1],s=Object(a.useState)(!1),o=Object(B.a)(s,2),u=o[0],d=o[1];Object(a.useEffect)((function(){xe(t,(function(){}))}),[]);return Object(G.jsxs)(F.a,{children:[Object(G.jsx)(W,{projects:!0}),Object(G.jsxs)(F.a,{className:"upload",children:[u?Object(G.jsx)(Le.a,{}):Object(G.jsx)(Re.a,{icon:be.a,size:30,color:"#C1C4D6",background:"#EDEFF5",className:"uploadIcon",padding:20,borderRadius:40}),Object(G.jsxs)(D.a,{className:"uploadTitle",children:["Uploading Layer to Project ",e]}),u?Object(G.jsx)(F.a,{className:"progress",children:Object(G.jsxs)(se.a,{className:"label",children:[r.toFixed(0),"%"]})}):Object(G.jsx)(Fe,{submit:function(n,a){if(!u)if(void 0!==n&&0!=n.length)if(void 0!==a&&0!=a.length){d(!0);var i=new FormData;i.append("project",e),i.append("layer",n),a.forEach((function(e){i.append("files",e)})),Y.post(S,i,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){return c(e.loaded/e.total*100)}}).then((function(e){console.log(e),t.push(p)}))}else Object(Be.b)("No files provided");else Object(Be.b)("No name specified")}})]})]})}var Ae=n(279),Ie=n(269),ze=n(270),He=n(271),Ye=n(117),Ue=n.n(Ye);function Ve(){var e,t=Object(a.useState)([]),n=Object(B.a)(t,2),i=n[0],r=n[1],c=Object(a.useState)(void 0),s=Object(B.a)(c,2),o=s[0],l=s[1],u=Object(a.useState)(!1),d=Object(B.a)(u,2),h=d[0],m=d[1],f=function t(){Y.get(N).then((function(n){console.log(n.data),r(n.data),e=setTimeout(t,2e3)}))};return Object(a.useEffect)((function(){return f(),function(){clearTimeout(e),r([])}}),[]),Object(G.jsxs)(F.a,{children:[Object(G.jsx)(Ae.a,{isShown:h,onCloseComplete:function(){return m(!1)},preventBodyScrolling:!0,children:Object(G.jsxs)(F.a,{className:"jsonRaw",children:[Object(G.jsxs)(D.a,{className:"jsonHeading",children:["Job ",null===o||void 0===o?void 0:o.job_id]}),Object(G.jsx)(F.a,{className:"json",children:Object(G.jsx)(Ue.a,{src:o,enableClipboard:!1,theme:{base00:"#FFF",base01:"#DDD",base02:"#DDD",base03:"#444",base04:"#BBB",base05:"#444",base06:"#444",base07:"#444",base08:"#444",base09:"#3366FF",base0A:"#3366FF",base0B:"#3366FF",base0C:"#3366FF",base0D:"#BBB",base0E:"#BBB",base0F:"#3366FF"}})})]})}),Object(G.jsxs)(je.a,{children:[Object(G.jsxs)(je.a.Head,{className:"row",children:[Object(G.jsx)(je.a.TextHeaderCell,{className:"wide",children:"Job Type"}),Object(G.jsx)(je.a.TextHeaderCell,{className:"wide",children:"Status"}),Object(G.jsx)(je.a.TextHeaderCell,{className:"wide",children:"Project"}),Object(G.jsx)(je.a.TextHeaderCell,{className:"narrow",children:"Log"}),Object(G.jsx)(je.a.TextHeaderCell,{className:"narrow",children:"Raw"})]}),Object(G.jsx)(je.a.Body,{children:i.length>0?i.map((function(e){return Object(G.jsxs)(je.a.Row,{paddingY:12,height:"auto",className:"row",children:[Object(G.jsx)(je.a.TextCell,{className:"wide",children:e.type}),Object(G.jsx)(je.a.TextCell,{className:"wide",children:e.status}),Object(G.jsx)(je.a.TextCell,{className:"wide",children:e.project?e.project:"--"}),Object(G.jsx)(je.a.TextCell,{className:"narrow",children:Object(G.jsx)(pe.a,{icon:Ie.a,onClick:function(){},disabled:!0})}),Object(G.jsx)(je.a.TextCell,{className:"narrow",children:Object(G.jsx)(pe.a,{icon:ze.a,onClick:function(){l(e),m(!0)}})})]},e.job_id)})):Object(G.jsx)(K.a,{background:"light",title:"No Running Jobs",orientation:"horizontal",icon:Object(G.jsx)(He.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5",description:"Jobs run in the background and process input data into visualizable elements"})})]})]})}var Ge=n(272);function Je(e){var t,n=Object(a.useState)(""),i=Object(B.a)(n,2),r=i[0],c=i[1],s=function n(){Y.post(T,{name:e.name}).then((function(e){c(e.data),t=setTimeout(n,2e3)}))};return Object(a.useEffect)((function(){return s(),function(){c(""),clearTimeout(t)}}),[e.name]),Object(G.jsx)(F.a,{className:"logContents",children:r&&r.length>0?Object(G.jsx)(Ge.a,{className:"logLines",children:r.split(/[\r\n]+/).map((function(e,t){return Object(G.jsx)("span",{children:e},t)}))}):Object(G.jsx)(Ge.a,{children:"No contents"})})}function We(){var e,t=Object(a.useState)([]),n=Object(B.a)(t,2),i=n[0],r=n[1],c=Object(a.useState)(void 0),s=Object(B.a)(c,2),o=s[0],l=s[1],u=function t(){Y.get(C).then((function(n){console.log(n.data),r(n.data),e=setTimeout(t,2e3)}))};return Object(a.useEffect)((function(){return u(),function(){r([]),clearTimeout(e)}}),[]),Object(G.jsxs)(F.a,{children:[Object(G.jsx)(Ee.a,{className:"logList",marginBottom:16,flexBasis:240,marginRight:24,children:i.map((function(e,t){return Object(G.jsx)(Ne.a,{id:e,onSelect:function(){return l(e)},isSelected:e===o,"aria-controls":"panel-".concat(e),className:"logTab",children:e},e)}))}),Object(G.jsx)(F.a,{children:o?Object(G.jsx)(Je,{name:o}):Object(G.jsx)(K.a,{background:"light",title:"No Log selected",orientation:"horizontal",icon:Object(G.jsx)(Ie.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5",description:"Logs contain debug information for running processes"})})]})}function qe(){var e=Object(l.g)();return Object(a.useEffect)((function(){xe(e,(function(){}))}),[]),Object(G.jsxs)(F.a,{children:[Object(G.jsx)(W,{jobs:!0}),Object(G.jsxs)(F.a,{className:"jobs",children:[Object(G.jsx)(D.a,{className:"jobsHeading",children:"Jobs"}),Object(G.jsx)(Ve,{})]}),Object(G.jsxs)(F.a,{className:"logs",children:[Object(G.jsx)(D.a,{className:"logsHeading",children:"Logs"}),Object(G.jsx)(We,{})]})]})}var Ke=n(34),Xe=n(3),Qe=n(4),Ze=n(8),$e=n(5),et=n(6),tt=n(83),nt=n(85),at=n(21),it=function(){function e(){Object(Xe.a)(this,e)}return Object(Qe.a)(e,null,[{key:"base64tofloat32",value:function(e,t,n){var a=window.atob(e),i=a.length/Float64Array.BYTES_PER_ELEMENT,r=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT)),c=new Float32Array(i),s=0,o=1,l=i*Float64Array.BYTES_PER_ELEMENT;console.log(l);!function e(){for(var i=1e4*o*Float64Array.BYTES_PER_ELEMENT;s<Math.min(i,l);s+=Float64Array.BYTES_PER_ELEMENT){for(var u=0;u<Float64Array.BYTES_PER_ELEMENT;++u)r.setUint8(u,a.charCodeAt(s+u));c[s/Float64Array.BYTES_PER_ELEMENT]=r.getFloat64(0,!0)}t.removed||(s<l?(o++,setTimeout(e,10)):(r=null,a=null,n(c)))}()}},{key:"base64toint32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,i=window.atob(e),r=i.length/Int32Array.BYTES_PER_ELEMENT,c=new DataView(new ArrayBuffer(Int32Array.BYTES_PER_ELEMENT)),s=new Uint32Array(r*Int32Array.BYTES_PER_ELEMENT),o=0,l=1,u=1e4,d=r*Int32Array.BYTES_PER_ELEMENT,h=function e(){for(var r=l*u*Int32Array.BYTES_PER_ELEMENT;o<Math.min(r,d);o+=Int32Array.BYTES_PER_ELEMENT){for(var h=0;h<Int32Array.BYTES_PER_ELEMENT;++h)c.setUint8(h,i.charCodeAt(o+h));s[o/Int32Array.BYTES_PER_ELEMENT]=c.getUint32(0,!0)+t}n.removed||(o<d?(l++,setTimeout(e,10)):(c=null,i=null,a(new Uint8Array(s.buffer))))};h()}}]),e}();function rt(e){for(var t=[],n=Math.PI/2,a=Math.PI/e,i=0;i<e;++i)t.push(0,0,0),t.push(Math.cos(n+a*i),Math.sin(n+a*i),0),t.push(Math.cos(n+a*(i+1)),Math.sin(n+a*(i+1)),0);return t}function ct(e){for(var t=[],n=Math.PI/2,a=Math.PI/e,i=0;i<e;++i)t.push(1,0,0),t.push(1-Math.cos(n+a*i),Math.sin(n+a*i),0),t.push(1-Math.cos(n+a*(i+1)),Math.sin(n+a*(i+1)),0);return t}function st(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[0,-1,0,1,-1,0,1,1,0,0,-1,0,1,1,0,0,1,0];return t=(t=t.concat(rt(e))).concat(ct(e))}var ot=function(){function e(t){Object(Xe.a)(this,e),this.renderer=void 0,this.mesh=void 0,this.pickingMesh=void 0,this.removed=void 0,this.renderer=t,this.removed=!1}return Object(Qe.a)(e,[{key:"remove",value:function(){this.mesh=this.removeFrom(this.mesh,this.renderer.scene),this.pickingMesh=this.removeFrom(this.pickingMesh,this.renderer.pickingScene),this.removed=!0}},{key:"removeFrom",value:function(e,t){e&&(t.remove(e),e.geometry.dispose())}}]),e}(),lt=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,a,i){var r,c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Object(Xe.a)(this,n),r=t.call(this,a);var s=a.picker.offsetForLayer(i.name);return it.base64tofloat32(e.vertices,Object(at.a)(r),(function(t){if(!r.removed)if(c)it.base64toint32(e.attributes.oid.data,s,Object(at.a)(r),(function(e){if(!r.removed){var n=r.createGeometry(t,e);r.createMesh(n,c),r.createPickingMesh(n),r.renderer.changed=!0,r.removed&&r.remove()}}));else{var n=r.createGeometry(t);r.createMesh(n,c),r.renderer.changed=!0,r.removed&&r.remove()}})),r}return Object(Qe.a)(n,[{key:"createPickingMesh",value:function(e){var t=new Ze.o(e,this.renderer.matlib.pickingMaterial);this.renderer.pickingScene.add(t),this.pickingMesh=t}},{key:"createMesh",value:function(e,t){var n=t?this.renderer.matlib.polygonSelectMaterial:this.renderer.matlib.polygonMaterial,a=new Ze.o(e,n);a.receiveShadow=!0,a.castShadow=!0,this.renderer.scene.add(a),this.mesh=a}},{key:"createGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new Ze.d;return n.setAttribute("position",new Ze.c(e,3)),t&&n.setAttribute("objectID",new Ze.c(t,4,!0)),n.computeVertexNormals(),n}}]),n}(ot),ut=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,a,i){var r;Object(Xe.a)(this,n),r=t.call(this,a);var c=a.picker.offsetForLayer(i.name);return it.base64tofloat32(e.vertices,Object(at.a)(r),(function(t){r.removed||it.base64toint32(e.attributes.oid.data,c,Object(at.a)(r),(function(e){if(!r.removed){var n=r.createGeometry(t);r.createMesh(n),r.renderer.changed=!0,r.removed&&r.remove()}}))})),r}return Object(Qe.a)(n,[{key:"createMesh",value:function(e){var t=new Ze.o(e,this.renderer.matlib.lineMaterial);t.frustumCulled=!1,this.renderer.scene.add(t),this.mesh=t}},{key:"createGeometry",value:function(e){var t=new Ze.i;return t.instanceCount=e.length/3,t.setAttribute("position",new Ze.c(new Float32Array(st()),3)),t.setAttribute("lineStart",new Ze.k(new Ze.j(e,6,1),3,0)),t.setAttribute("lineEnd",new Ze.k(new Ze.j(e,6,1),3,3)),t}}]),n}(ot),dt=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,a,i){var r;Object(Xe.a)(this,n),r=t.call(this,a);var c=a.picker.offsetForLayer(i.source);return it.base64tofloat32(e.vertices,Object(at.a)(r),(function(t){r.removed||it.base64toint32(e.attributes.oid.data,c,Object(at.a)(r),(function(e){if(!r.removed){var n=r.createGeometry(t);r.createMesh(n),r.renderer.changed=!0,r.removed&&r.remove()}}))})),r}return Object(Qe.a)(n,[{key:"createMesh",value:function(e){var t=new Ze.o(e,this.renderer.matlib.lineMaterial);t.frustumCulled=!1,this.renderer.scene.add(t),this.mesh=t}},{key:"createGeometry",value:function(e){var t=new Ze.i;return t.instanceCount=e.length/3,t.setAttribute("position",new Ze.c(new Float32Array(st()),3)),t.setAttribute("lineStart",new Ze.k(new Ze.j(e,6,1),3,0)),t.setAttribute("lineEnd",new Ze.k(new Ze.j(e,6,1),3,3)),t}}]),n}(ot),ht=function(){function e(t,n,a){Object(Xe.a)(this,e),this.bbox=void 0,this.brect=void 0,this.x=void 0,this.y=void 0,this.renderer=void 0,this.layer=void 0,this.sourceFile=void 0,this.stopFlag=void 0,this.isVisible=void 0,this.models=void 0,this.bbox=[Object(tt.a)(Ze.B,Object(nt.a)(t.box[0])),Object(tt.a)(Ze.B,Object(nt.a)(t.box[1]))],this.brect=[new Ze.A(this.bbox[0].x,this.bbox[0].y),new Ze.A(this.bbox[1].x,this.bbox[1].y)],this.x=t.x,this.y=t.y,this.sourceFile=t.file,this.layer=a,this.renderer=n,this.isVisible=!1,this.models=[]}return Object(Qe.a)(e,[{key:"visible",set:function(e){this.isVisible!==e&&(this.isVisible=e,e?this.forRender():this.stopRender())}},{key:"forRender",value:function(){var e=this;this.stopFlag=z.a.CancelToken.source(),Y.get("/api/data/".concat(this.layer.project,"/").concat(this.layer.name,"/grid/tiles/").concat(this.sourceFile),{cancelToken:this.stopFlag.token}).then((function(t){e.createModels(t.data),e.postRenderCheck()})).catch((function(e){console.log(e)}))}},{key:"createModels",value:function(e){var t,n=Object(Ke.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,i=this.deserializeModel(a);i&&this.models.push(i)}}catch(r){n.e(r)}finally{n.f()}}},{key:"deserializeModel",value:function(e){if(e.tags&&!0===e.tags.proxy){if("simpleline"===e.type)return new dt(e,this.renderer,this.layer)}else{if("simplepolygon"===e.type)return new lt(e,this.renderer,this.layer);if("simpleline"===e.type)return new ut(e,this.renderer,this.layer)}}},{key:"postRenderCheck",value:function(){this.isVisible||this.stopRender()}},{key:"stopRender",value:function(){if(this.models.length>0){var e,t=Object(Ke.a)(this.models);try{for(t.s();!(e=t.n()).done;){e.value.remove()}}catch(n){t.e(n)}finally{t.f()}this.models=[]}this.stopFlag&&(this.stopFlag.cancel(),this.stopFlag=null)}}]),e}();function mt(e,t){var n=Math.max(Math.abs(e),Math.abs(t));if(0===e&&0===t)return 0;var a,i=8*((a=n-1)*(a+1)/2);if(e>Math.abs(t)||e===t&&e>0)return i+n+t;if((t>Math.abs(e)||t===-e)&&t>0)return i+4*n-n-e;if(e<t||e===t&&e<0)return i+5*n-t;if(t<e||-t===e&&t<0)return i+7*n+e;throw"Cannot covert to 1D"}var ft=function(){function e(t,n,a){var i;Object(Xe.a)(this,e),this.bbox=void 0,this.brect=void 0,this.focusPoint=void 0,this.renderer=void 0,this.tileSize=void 0,this.tiles=void 0,this.visible_radius=void 0,this.visible=void 0,this.visibleSwap=void 0,this.zero2=void 0,this.layer=void 0,this.tileSize=t.tile_size,this.renderer=n,this.layer=a,this.bbox=[new Ze.B(1/0,1/0,1/0),new Ze.B(-1/0,-1/0,-1/0)],this.tiles=new Map,this.createTiles(t,n,a),this.brect=[new Ze.A(this.bbox[0].x,this.bbox[0].y),new Ze.A(this.bbox[1].x,this.bbox[1].y)],this.focusPoint=(i=this.bbox,new Ze.A(.5*(i[0].x+i[1].x),.5*(i[0].y+i[1].y))),this.visible_radius=2e3,this.visibleSwap=new Set,this.visible=new Set,this.zero2=new Ze.A}return Object(Qe.a)(e,[{key:"createTiles",value:function(e,t,n){var a,i,r,c=Object(Ke.a)(e.tiles);try{for(c.s();!(a=c.n()).done;){var s=a.value,o=mt(s.x,s.y),l=new ht(s,t,n);i=this.bbox,r=l.bbox,i[0].min(r[0]),i[1].max(r[1]),this.tiles.set(o,l)}}catch(u){c.e(u)}finally{c.f()}}},{key:"focus",value:function(e){var t=this.focusPoint.clone().divideScalar(this.tileSize).floor(),n=e.clone().sub(this.brect[0]).divideScalar(this.tileSize).floor();t.equals(n)||(this.focusPoint=e,this.update_visibility())}},{key:"update_visibility",value:function(){var e=this,t=this.visible;this.visible=this.visibleSwap,this.visibleSwap=t;var n=this.focusPoint.clone().divideScalar(this.tileSize).floor(),a=Math.ceil(this.visible_radius/this.tileSize),i=n.clone().subScalar(a),r=n.clone().addScalar(a+1);this.visible.clear();for(var c=i.x;c<r.x;++c)for(var s=i.y;s<r.y;++s){var o=mt(c,s),l=this.tiles.get(o);l&&(l.visible=!0,this.visible.add(l))}this.visibleSwap.forEach((function(t){e.visible.has(t)||(t.visible=!1)}))}}]),e}(),jt=function(){function e(t,n,a){Object(Xe.a)(this,e),this.name=void 0,this.project=void 0,this.renderer=void 0,this.grid=void 0,this.name=a.name,this.project=n,this.renderer=t,this.renderer.style.layer(this.name).visible&&(this.grid=new ft(a.layout,t,this))}return Object(Qe.a)(e,[{key:"focus",value:function(e){this.grid&&this.grid.focus(e)}}]),e}(),pt=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,a,i){var r;return Object(Xe.a)(this,n),(r=t.call(this,e,a,i)).size=void 0,r.size=i.size,r.renderer.picker.registerLayer(r.name,r.size),r.grid&&r.renderer.focus(r.grid.focusPoint),r}return n}(jt),bt=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,a,i){var r;return Object(Xe.a)(this,n),(r=t.call(this,e,a,i)).source=void 0,r.target=void 0,r.source=i.source,r.target=i.target,r.grid&&r.renderer.focus(r.grid.focusPoint),r}return n}(jt),vt=n(121),gt=n(84),Ot=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,a){var i;return Object(Xe.a)(this,n),e.up=new Ze.B(0,0,1),(i=t.call(this,e,a)).screenSpacePanning=!1,i.mouseButtons.LEFT=Ze.l.PAN,i.mouseButtons.RIGHT=Ze.l.ROTATE,i.touches.ONE=Ze.y.PAN,i.touches.TWO=Ze.y.DOLLY_ROTATE,i.zoomSpeed=.5,i.dampingFactor=.1,i.enableDamping=!0,i.minDistance=5,i.minPolarAngle=.001,i.update(),i}return n}(n(118).a),xt=function(){function e(t){Object(Xe.a)(this,e),this.pickingTexture=void 0,this.pixelBuffer=void 0,this.renderer=void 0,this.selected=void 0,this.id=void 0,this.offsets=void 0,this.maxOffest=void 0,this.pickingTexture=new Ze.C(1,1),this.pixelBuffer=new Uint8Array(4),this.renderer=t,this.selected=[-1,-1,-1,-1],this.id=-1,this.offsets=new Map,this.maxOffest=0}return Object(Qe.a)(e,[{key:"registerLayer",value:function(e,t){this.offsets.has(e)&&console.error("Registering layer ".concat(e," twice.")),this.offsets.set(e,[this.maxOffest,this.maxOffest+t]),this.maxOffest+=t}},{key:"offsetForLayer",value:function(e){this.offsets.has(e)||console.error("Layer ".concat(e," was not registered into the picker."));var t=this.offsets.get(e);return t?t[0]:0}},{key:"layerAndOidForId",value:function(e){var t,n=Object(Ke.a)(this.offsets.entries());try{for(n.s();!(t=n.n()).done;){var a=Object(B.a)(t.value,2),i=a[0],r=a[1];if(e>=r[0]&&e<r[1])return{layer:i,oid:e-r[0]}}}catch(c){n.e(c)}finally{n.f()}}},{key:"pick",value:function(e,t,n,a){var i=this.pickingTexture,r=this.pixelBuffer,c=this.renderer.getPixelRatio();return a.setViewOffset(this.renderer.getContext().drawingBufferWidth,this.renderer.getContext().drawingBufferHeight,e*c|0,t*c|0,1,1),this.renderer.setRenderTarget(i),this.renderer.render(n,a),this.renderer.setRenderTarget(null),a.clearViewOffset(),this.renderer.readRenderTargetPixels(i,0,0,1,1,r),this.selected=[r[0]/255,r[1]/255,r[2]/255,r[3]/255],this.id=new DataView(r.buffer).getUint32(0,!0),this.id}}]),e}();var _t=function e(t){Object(Xe.a)(this,e),this.polygonMaterial=void 0,this.polygonSelectMaterial=void 0,this.lineMaterial=void 0,this.pickingMaterial=void 0,this.polygonMaterial=new Ze.p({side:Ze.f}),t.setupMaterial(this.polygonMaterial),this.polygonSelectMaterial=function(){var e=Ze.z.merge([Ze.v.phong.uniforms,{selectedID:{value:[-1,-1,-1,-1]}}]);return new Ze.w({uniforms:e,vertexShader:"\n#define PHONG\n\nvarying vec3 vViewPosition;\n\nuniform vec4 selectedID;\n\nattribute vec4 objectID;\nvarying float varyingObjectID;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n    int marked = 1;\n\n    for(int i = 0; i < 4; ++i)\n        marked *= int(floor(selectedID[i] * 255.0 + 0.5) == floor(objectID[i] * 255.0 + 0.5));\n\n    varyingObjectID = float(marked);\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",fragmentShader:"\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\nvarying float varyingObjectID;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n    vec3 marked = vec3(0.5 * float(varyingObjectID > 0.5));\n\n\tvec4 diffuseColor = vec4( diffuse + marked, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",lights:!0,side:Ze.f,name:"custom-polygon-material"})}(),t.setupMaterial(this.polygonSelectMaterial),this.lineMaterial=function(){var e=Ze.z.merge([{zoffset:{value:1}}]);return new Ze.w({uniforms:e,vertexShader:"\n#define PHONG\n\nvarying vec3 vViewPosition;\n\nattribute vec3 lineStart;\nattribute vec3 lineEnd;\nuniform float zoffset;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n/**\n * Create rotation matrix from field vector.\n * The returned matrix can rotate vector (1, 0, 0)\n * into the desired setup.\n */\nmat4 getRotationMat(vec3 vector)\n{\n\tvec3 unit = vec3(1, 0, 0);\n\tvec3 f = normalize(vector);\n\tvec3 cross = cross(f, unit);\n\tvec3 a = normalize(cross);\n\tfloat s = length(cross);\n\tfloat c = dot(f, unit);\n\tfloat oc = 1.0 - c;\n\treturn mat4(oc * a.x * a.x + c,        oc * a.x * a.y - a.z * s,  oc * a.z * a.x + a.y * s,  0.0,\n                oc * a.x * a.y + a.z * s,  oc * a.y * a.y + c,        oc * a.y * a.z - a.x * s,  0.0,\n                oc * a.z * a.x - a.y * s,  oc * a.y * a.z + a.x * s,  oc * a.z * a.z + c,        0.0,\n                0.0,                       0.0,                       0.0,                       1.0);\n\n}\n\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\n\t#include <begin_vertex>\n\n\tvec3 dir = lineEnd - lineStart;\n    float dist = length(dir);\n    mat4 rot = getRotationMat(dir);\n\n\tconst float thickness = 1.0;\n\tfloat end = float(transformed.x >= 0.9);\n\ttransformed.x = end * (dist - 1.0 + transformed.x) + (1.0 - end) * transformed.x; //subtract one because its the original length of the template line\n\ttransformed.y *= thickness;\n\n    transformed = lineStart + (rot * vec4(transformed, 1.0)).xyz;\n\ttransformed.z += zoffset;\n\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",fragmentShader:"\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t//#include <lights_phong_fragment>\n\t//#include <lights_fragment_begin>\n\t//#include <lights_fragment_maps>\n\t//#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",side:Ze.f,name:"custom-line-material"})}(),this.pickingMaterial=function(){var e=Ze.z.merge([]);return new Ze.w({uniforms:e,vertexShader:"\nattribute vec4 objectID;\nvarying vec4 objectIDColor;\n\nvoid main() {\n    objectIDColor = objectID;\n    gl_Position = projectionMatrix * (modelViewMatrix * vec4( position, 1.0 ));\n}\n",fragmentShader:"\nvarying vec4 objectIDColor;\n\nvoid main() {\n\tgl_FragColor = vec4(objectIDColor);\n}\n",side:Ze.f,name:"custom-picking-material"})}()},yt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(Xe.a)(this,e),this.visible=!0,this.apply(t)}return Object(Qe.a)(e,[{key:"apply",value:function(e){for(var t in this)void 0!==e[t]&&(this[t]=e[t])}}]),e}(),wt=function(){function e(t){Object(Xe.a)(this,e),this.style=void 0,this.style=t}return Object(Qe.a)(e,[{key:"layer",value:function(e){var t=this.style[e];return t?new yt(t):new yt}}]),e}(),St=function(){function e(t){Object(Xe.a)(this,e),this.canvas=void 0,this.scene=void 0,this.pickingScene=void 0,this.renderer=void 0,this.camera=void 0,this.controls=void 0,this.csm=void 0,this.picker=void 0,this.style=void 0,this.matlib=void 0,this.stats1=void 0,this.stats2=void 0,this.changed=void 0,this.canvas=t,this.scene=new Ze.t,this.pickingScene=new Ze.t,this.camera=new Ze.r(75,window.innerWidth/window.innerHeight,.1,5e3),this.renderer=new Ze.D({canvas:this.canvas,antialias:!0}),this.setupRenderer(),this.controls=new Ot(this.camera,this.canvas),this.setupLightsAndShadows(),this.matlib=new _t(this.csm),this.style=new wt({DOP_TSK_UlicUsPAKOM_l:{visible:!1}}),this.picker=new xt(this.renderer),this.changed=!0,this.stats1=Object(gt.a)(),this.stats1.showPanel(0),this.stats1.dom.style.cssText="position:absolute;top:0px;left:0px;",document.body.appendChild(this.stats1.dom),this.stats2=Object(gt.a)(),this.stats2.showPanel(1),this.stats2.dom.style.cssText="position:absolute;top:0px;left:80px;",document.body.appendChild(this.stats2.dom)}return Object(Qe.a)(e,[{key:"setupLightsAndShadows",value:function(){this.scene.add(new Ze.h(14540253,5592405,.6)),this.scene.add(new Ze.a(16777215,.2)),this.csm=new vt.a({fade:!0,mode:"practical",cascades:4,near:1,far:5e3,shadowBias:-5e-4,shadowMapSize:2048,lightDirection:new Ze.B(-1,-1,-2).normalize(),camera:this.camera,parent:this.scene,margin:5e3,lightFar:2e4,lightNear:1,lightIntensity:.3})}},{key:"setupRenderer",value:function(){var e=this;this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.autoUpdate=!1,this.renderer.shadowMap.type=Ze.q,this.renderer.setClearColor(16777215),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setAnimationLoop((function(){return e.frame()}))}},{key:"frame",value:function(){this.controls.update(),this.changed&&(this.csm.update(),this.renderer.shadowMap.needsUpdate=!0,this.renderer.render(this.scene,this.camera)),this.stats1.update(),this.stats2.update(),this.changed=!1}},{key:"focus",value:function(e){this.controls.target=new Ze.B(e.x,e.y,0),this.camera.position.x=e.x,this.camera.position.y=e.y-20,this.camera.position.z=1e3}},{key:"click",value:function(e,t){var n=this.picker.pick(e,t,this.pickingScene,this.camera);console.log(n),console.log(this.picker.layerAndOidForId(n)),this.matlib.polygonSelectMaterial.uniforms.selectedID={value:this.picker.selected},this.matlib.polygonSelectMaterial.uniformsNeedUpdate=!0,this.changed=!0}},{key:"focus_point",get:function(){return this.controls.target}}]),e}(),kt=function(){function e(t,n){Object(Xe.a)(this,e),this.project=void 0,this.canvas=void 0,this.renderer=void 0,this.layers=void 0,this.project=t,this.canvas=n,this.renderer=new St(this.canvas),this.layers=[]}return Object(Qe.a)(e,[{key:"init",value:function(){var e=this;Y.get("/api/data/".concat(this.project,"/layout.json")).then((function(t){var n,a=Object(Ke.a)(t.data);try{for(a.s();!(n=a.n()).done;){var i=n.value;i.init&&("layer"===i.type&&e.layers.push(new pt(e.renderer,e.project,i)),"overlay"===i.type&&e.layers.push(new bt(e.renderer,e.project,i)))}}catch(r){a.e(r)}finally{a.f()}})),this.renderer.controls.addEventListener("change",(function(){return e.moved()}))}},{key:"moved",value:function(){var e,t=this.renderer.focus_point,n=new Ze.A(t.x,t.y),a=Object(Ke.a)(this.layers);try{for(a.s();!(e=a.n()).done;){e.value.focus(n)}}catch(i){a.e(i)}finally{a.f()}this.renderer.changed=!0}},{key:"doubleclick",value:function(e,t){this.renderer.click(e,t)}},{key:"exit",value:function(){}}]),e}();function Et(){var e,t=Object(l.h)().project_name,n=Object(a.createRef)();return Object(a.useEffect)((function(){if(null!=n.current)return(e=new kt(t,n.current)).init(),e.renderer.frame(),function(){e.exit(),window.location.reload()}}),[n,t]),Object(G.jsx)("div",{children:Object(G.jsx)("canvas",{ref:n,onDoubleClick:function(t){return e.doubleclick(t.clientX,t.clientY)},children:"Your browser does not support HTML5 canvas"})})}function Nt(){return Object(G.jsxs)(o.a,{children:[Object(G.jsx)(Be.a,{position:"top-center",autoClose:1e4,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,pauseOnHover:!0}),Object(G.jsxs)(l.d,{children:[Object(G.jsx)(l.b,{exact:!0,path:["/"],children:Object(G.jsx)(l.a,{to:"/app"})}),Object(G.jsx)(l.b,{path:d,children:Object(G.jsx)(_e,{})}),Object(G.jsx)(l.b,{path:b,children:Object(G.jsx)(De,{})}),Object(G.jsx)(l.b,{path:f,children:Object(G.jsx)(Me,{})}),Object(G.jsx)(l.b,{path:p,children:Object(G.jsx)(qe,{})}),Object(G.jsx)(l.b,{path:h,children:Object(G.jsx)(Et,{})}),Object(G.jsx)(l.b,{path:u,children:Object(G.jsx)(q,{})})]})]})}c.a.render(Object(G.jsx)(i.a.StrictMode,{children:Object(G.jsx)(s.a.Provider,{value:{className:"react-icons"},children:Object(G.jsx)(Nt,{})})}),document.getElementById("root"))}},[[228,1,2]]]);
//# sourceMappingURL=main.b99c9e70.chunk.js.map